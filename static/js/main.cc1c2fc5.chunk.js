(this["webpackJsonpfantasy-slots"]=this["webpackJsonpfantasy-slots"]||[]).push([[0],{12:function(e,t,a){},14:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),c=a(6),r=a.n(c),s=(a(12),{state:{gameData:null,spinning:!1,tilesToPick:[],selectedTile:null},_update:function(e){},update:function(){s._update(Math.random())}});window.store=s;var o=a(0);function l(e){var t=e.tile,a=e.showValue,n=e.onClick,i=["tile"];return t.data.highlight&&i.push("highlight"),Object(o.jsxs)("div",{className:i.join(" "),onClick:function(){s.state.selectedTile=t,s.update(),n&&n()},children:[!!t.data.spinValue&&a&&Object(o.jsx)("div",{className:"value",children:t.data.spinValue}),Object(o.jsx)(t.config.icon,{})]})}function d(e){var t=e.boardTiles,a=e.gameTiles,n=e.width,i=e.height,c={fontSize:"1.5em",gridTemplateColumns:"repeat(".concat(n,", 5em)"),gridTemplateRows:"repeat(".concat(i,", 5em)")};return Object(o.jsx)("div",{className:"board",style:c,children:t.map((function(e,t){var n=a[e];return Object(o.jsx)(l,{tile:n,showValue:!0,onClick:function(){}},n.id)}))})}function u(e){var t=e.tiles;return Object(o.jsx)("div",{className:"inventory",children:t.map((function(e){return Object(o.jsx)(l,{tile:e},e.id)}))})}var f=a(2),g=0,h=1,j=2,b=3,m=a.p+"static/media/key.0629d73b.png",p=a.p+"static/media/chest1.b4054229.png",v=a.p+"static/media/chest2.d4ed67d0.png",O=a.p+"static/media/chest3.888bf5be.png",x=a.p+"static/media/chest4.28dffa1b.png",y=a.p+"static/media/coal.d3a30adc.png",T=a.p+"static/media/coin.3480412c.png",k=a.p+"static/media/dagger1.6892c2d5.png";function D(e){var t=e.image;return Object(o.jsx)("img",{className:"icon",src:t,alt:""})}var A=function(){return Object(o.jsx)(D,{image:p})},C=function(){return Object(o.jsx)(D,{image:v})},V=function(){return Object(o.jsx)(D,{image:O})},w=function(){return Object(o.jsx)(D,{image:x})},S=function(){return Object(o.jsx)(D,{image:T})};function M(e,t){var a=e.getAdjacentIndexes();e.getTiles(a).forEach(t)}var I=[{id:"48217c09-300c-44b0-803e-19f51346227b",name:"Coal",icon:function(){return Object(o.jsx)(D,{image:y})},rarity:g,categories:[],calculateValue:function(e){var t=1;return M(e,(function(e){"Coal"===e.config.name&&(t+=1)})),t}},{id:"2f2e6e35-686f-4033-9940-3f66a153c568",name:"Dagger",icon:function(){return Object(o.jsx)(D,{image:k})},rarity:g,categories:[],calculateValue:function(e){return 1}},{id:"49d24981-a7d1-4407-b121-ed3e45d427bd",name:"Coin",icon:S,rarity:g,categories:[],calculateValue:function(e){return 1}}];var N=a(16);function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{spinValue:0,totalSpins:0,totalAppearances:0,highlight:!1},a={id:Object(N.a)(),configId:e.id,config:e,effects:{},data:t};return a}function H(e,t){var a=0;e.config.onDestroy&&(a=e.config.onDestroy(t)||0);var n=t.gameData.gameTiles,i=n.indexOf(e),c=B(F);n[i]=c,a&&(c.data.spinValue=a)}var W=[{id:"2ef31449-bf1d-4cee-8e93-e0665fb9942a",name:"Key",description:function(){return Object(o.jsxs)(o.Fragment,{children:["The key unlocks ",Object(o.jsx)(A,{})," ",Object(o.jsx)(C,{})," ",Object(o.jsx)(V,{})," ",Object(o.jsx)(w,{}),", destroying both in the process"]})},icon:function(){return Object(o.jsx)(D,{image:m})},rarity:g,categories:["key"],calculateValue:function(e){var t=!1;return M(e,(function(a){(function(e,t){return e.config.categories.includes(t)})(a,"chest")&&(H(a,e),t=!0)})),t&&H(e.tile,e),1}},{id:"834bf40d-0a3d-4e20-83a0-4e3aa233840c",name:"Small Chest",description:function(){return Object(o.jsxs)(o.Fragment,{children:["Unlocked by the key, gives 10 ",Object(o.jsx)(S,{})]})},icon:A,rarity:g,categories:["chest"],calculateValue:function(e){return 1},onDestroy:function(e){return 10}},{id:"c87ea7e4-5479-4aa7-9033-0859d191390b",name:"Medium Chest",description:function(){return Object(o.jsxs)(o.Fragment,{children:["Unlocked by the key, gives 30 ",Object(o.jsx)(S,{})]})},icon:C,rarity:h,categories:["chest"],calculateValue:function(e){return 1},onDestroy:function(e){return 30}},{id:"8abbd4fc-1fee-4c14-b5c2-2a627de70dd1",name:"Large Chest",icon:V,rarity:j,categories:["chest"],calculateValue:function(e){return 1},onDestroy:function(e){alert("destroyed")}},{id:"3422f3a8-bd1a-4549-a9ff-d0ed0621d646",name:"Dark Chest",icon:w,rarity:b,categories:["chest"],calculateValue:function(e){return 1},onDestroy:function(e){alert("destroyed")}}],E=[].concat(Object(f.a)(I),Object(f.a)(W)),P=new Map,J=new Map;E.forEach((function(e){P.set(e.id,e),J.set(e.name,e)}));var F={id:"04f5df2c-22d6-4e31-8e81-c81f0ba1c4c1",name:"Empty",icon:function(){return Object(o.jsx)(D,{image:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})},rarity:g,categories:["empty"],calculateValue:function(e){return e.tile.data.spinValue||0}},R=a(7);function z(e,t){return Math.floor(Math.random()*(t-e+1))+e}var U="9c0617fc-daf3-4f9c-943e-073f698ac0b8";function _(e,t){return e.find((function(e){return e.configId===t}))}function G(e,t){var a,n=e.reduce((function(e,a){return a.config.rarity<=t&&e.push(a),e}),[]);return(a=n)[z(0,a.length-1)]}function K(){for(var e=s.state.gameData,t=e.gameTiles,a=e.gridWidth,n=e.gridHeight,i=0;t.length<a*n;i++)t.push(B(F))}function L(){var e=s.state.gameData,t=e.gridWidth,a=e.gridHeight,n=e.deckTiles;e.boardTiles=function(){for(var e=s.state.gameData,t=e.gameTiles,a=e.gridWidth,n=e.gridHeight,i=[],c=Object(f.a)(t),r=0;r<a*n;r++){var o=Math.floor(Math.random()*c.length),l=c[o],d=t.indexOf(l);i.push(d),c.splice(o,1)}return i}(),function(){for(var e=s.state.gameData,t=e.gridWidth,a=e.gridHeight,n=e.gameTiles,i=e.boardTiles,c=0;c<t*a;c++)n[i[c]].data.spinValue=0}(),s.state.gameData.gameTiles.forEach((function(e){e.data.totalSpins++})),s.state.spinning=!0,s.update();var i=0,c=setInterval((function(){var r=e.boardTiles,o=e.gameTiles;i>0&&i<=t*a&&(o[r[i-1]].data.highlight=!1);if(i>t*a)return clearInterval(c),s.state.spinning=!1,s.state.gameData.totalCoins+=s.state.gameData.boardValue,s.state.tilesToPick=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=Object(f.a)(e),n=[],i=0;i<t;i++){var c=z(0,a.length-1),r=a.splice(c,1)[0];r&&n.push(B(r.config))}return n}(n),s.update(),void function(){var e=localStorage["".concat(U)];(e=e?JSON.parse(e):{}).gameState=s.state.gameData,localStorage["".concat(U)]=JSON.stringify(e)}();if(i<t*a){var l=o[r[i]];l.data.highlight=!0,l.data.totalAppearances++,l.data.spinValue=function(e,t){var a=s.state.gameData,n=a.gridWidth,i=a.gridHeight;console.log("Tile Index",t);var c={tile:e,gameData:a,getAdjacentIndexes:function(){return function(e,t,a){var n=[];n.push(e+t),n.push(e-t),n.push(e+1),n.push(e-1),n.push(e+t-1),n.push(e+t+1),n.push(e-t-1),n.push(e-t+1);for(var i=7;i>=0;i--)Q(e,n[i],t,a)||n.splice(i,1);return n}(t,n,i)},getTiles:X};return e.config.calculateValue(c)}(l,i)}i++;var d,u=0,g=Object(R.a)(r);try{for(g.s();!(d=g.n()).done;){u+=o[r[d.value]].data.spinValue}}catch(h){g.e(h)}finally{g.f()}s.state.gameData.boardValue=u,s.update()}),100)}function Q(e,t,a,n){return!(t<0||t>=a*n)&&((e+1!==t&&e-1!==t||Math.floor(t/a)===Math.floor(e/a))&&((e+a+1!==t&&e+a-1!==t||Math.floor(t/a)===Math.floor((e+a)/a))&&(e-a+1!==t&&e-a-1!==t||Math.floor(t/a)===Math.floor((e-a)/a))))}function X(e){var t=s.state.gameData,a=t.boardTiles,n=t.gameTiles;return e.map((function(e){return n[a[e]]}))}function Y(e){var t=J.get(e);!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=s.state.gameData.ownedTiles;if(_(t,e.id))console.log("Already own tile ".concat(e.name));else{console.log("Adding owned tile ".concat(e.name));var a=B(e);t.push(a)}}(t),function(e){if(e){var t=s.state.gameData.deckTileIds;t.includes(e)||t.push(e)}}(null===t||void 0===t?void 0:t.id)}function Z(){s.state.gameData={boardTiles:[],ownedTiles:[],deckTileIds:[],deckTiles:[],gameTiles:[],gridWidth:3,gridHeight:3,boardValue:0,totalCoins:0},Y("Coal"),Y("Dagger"),Y("Key"),Y("Small Chest"),Y("Medium Chest"),function(){var e=s.state.gameData,t=e.deckTileIds,a=e.ownedTiles;e.deckTiles=t.map((function(e){return _(a,e)||B(F)}))}(),function(){for(var e=s.state.gameData,t=e.deckTiles,a=[],n=0;n<5;n++){var i=G(t,g);a.push(B(i.config))}e.gameTiles=a,K()}()}function q(e){var t=e.tile,a=e.onClick;if(!t)return null;var n=t.config;return Object(o.jsxs)("div",{className:"tile-details",onClick:a,children:[Object(o.jsx)("div",{className:"name",children:n.name}),Object(o.jsx)(t.config.icon,{}),Object(o.jsx)("div",{className:"description",children:n.description&&n.description()})]})}function $(){var e=s.state.tilesToPick;return Object(o.jsx)("div",{className:"pick-a-tile",children:e.map((function(e){return Object(o.jsx)(q,{tile:e,onClick:function(){!function(e){var t=s.state.gameData.gameTiles,a=t.findIndex((function(e){return e.config.id===F.id}));console.log(a),a>=0?t.splice(a,1,e):t.push(e)}(e),s.state.tilesToPick=[],s.state.gameData.boardTiles=[],s.update()}})}))})}var ee=[{id:"bbe17879-f3ee-47fc-9e76-2fa8cc0ebc0d",name:"Board Width",cost:function(){return 0},buy:function(){s.state.gameData.gridWidth+=1,K(),s.update()},isComplete:function(){return!1}},{id:"1e0ab330-8ec9-4e41-933d-75251ffa5ee5",name:"Board Height",cost:function(){return 0},buy:function(){s.state.gameData.gridHeight+=1,K(),s.update()},isComplete:function(){return!1}},{id:"0245c559-dd55-4f93-a626-53cc06b17d42",name:"XYZ",cost:function(){return 0},buy:function(){},isComplete:function(){return!1}}];function te(){return Object(o.jsx)("div",{className:"upgrades",children:ee.map((function(e){return Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{children:e.name}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{onClick:e.buy,children:"Buy"})})]},e.id)}))})}!function(){var e,t=localStorage["".concat(U)];null===(e=t=t?JSON.parse(t):{})||void 0===e||e.gameState}();var ae=function(){var e=Object(n.useState)(0)[1];Object(n.useEffect)((function(){s._update=e}),[e]),s.state.gameData||Z();var t=s.state,a=t.gameData,i=t.tilesToPick,c=null;return s.state.spinning||i.length||(c=Object(o.jsx)(o.Fragment,{children:Object(o.jsx)("button",{onClick:L,children:"Spin"})})),Object(o.jsxs)("div",{className:"app",children:[Object(o.jsxs)("div",{style:{fontSize:"3em"},children:[a.totalCoins," Coins"]}),!!i.length&&Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Pick New Tile"}),Object(o.jsx)($,{})]}),Object(o.jsxs)("div",{style:{opacity:i.length?.5:1},children:[Object(o.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Board"}),Object(o.jsx)(d,{boardTiles:a.boardTiles,gameTiles:a.gameTiles,width:a.gridWidth,height:a.gridHeight}),c,Object(o.jsxs)("div",{style:{fontSize:"2em"},children:["Board value:"," ",Object(o.jsx)("b",{children:!!a.boardValue&&a.boardValue||0})]})]}),Object(o.jsx)("div",{style:{width:"1em"}}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Selected Tile"}),Object(o.jsx)(q,{tile:s.state.selectedTile,onClick:function(){s.state.selectedTile=void 0,s.update()}})]})]}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Game Tiles"}),Object(o.jsx)(u,{tiles:a.gameTiles})]}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Deck"}),Object(o.jsx)(u,{tiles:a.deckTiles})]}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Owned Inventory"}),Object(o.jsx)(u,{tiles:a.ownedTiles})]}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Upgrades"}),Object(o.jsx)(te,{})]}),Object(o.jsx)("button",{onClick:function(){Z(),s.update()},children:"Reset all game data"})]})]})};r.a.render(Object(o.jsx)(i.a.StrictMode,{children:Object(o.jsx)(ae,{})}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.cc1c2fc5.chunk.js.map